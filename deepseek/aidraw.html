<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIç»˜ç”»- æ¢ç´¢æœªçŸ¥ä¹‹å¢ƒ</title>
    <link rel="stylesheet" href="deepseek.css">
    <!-- Markdown æ¸²æŸ“åº“ -->
    <script src="marked.min.js"></script>
    <!-- ä»£ç é«˜äº®åº“ -->
    <link rel="stylesheet" href="github-dark.min.css">
    <script src="highlight.min.js"></script>
    <!-- Font Awesome å›¾æ ‡åº“ -->
    <link rel="stylesheet" href="all.min.css">
	
</head>
<body>
    <div class="container" id="maincontainer">		
        <div class="left-column">		
			<!-- èŠå¤©åŒºåŸŸ -->
				<h2 style="text-align:center;" ><img class ="logo"  src="draw.png" /> AIç»˜ç”»ï¼Œæƒ³è±¡ä¸åˆ›æ„</h2>			
			<!-- è¾“å…¥æ¡†åŒºåŸŸ -->
			<div class="loading-container">
			<!-- åŠ è½½çŠ¶æ€ -->
			<div id="loading" style="display: none;"><img src="loading.gif" />æ€è€ƒä¸­...</div>
			
			</div>
                <div class="prompt-helper">
                    <h3>ç»˜ç”»æç¤ºè¯</h3>
                    <div class="prompt-tags-container">
                        <div class="prompt-tag" data-prompt="ä¸€åªå¯çˆ±çš„çŒ«å’ªåœ¨ç©æ¯›çº¿çƒ">ğŸ± çŒ«å’ªç©æ¯›çº¿çƒ</div>
                        <div class="prompt-tag" data-prompt="ä¸€æ¡å½©è‰²çš„å°é±¼åœ¨æµ·åº•æ¸¸æ³³ï¼Œå‘¨å›´æœ‰çŠç‘š">ğŸŸ å½©è‰²å°é±¼æ¸¸æ³³</div>
                        <div class="prompt-tag" data-prompt="ä¸€ä¸ªå®‡èˆªå‘˜åœ¨å¤ªç©ºä¸­æ¼‚æµ®">ğŸ‘¨â€ğŸš€ å®‡èˆªå‘˜å¤ªç©ºæ¼‚æµ®</div>
                        <div class="prompt-tag" data-prompt="ä¸€åº§é­”æ³•åŸå ¡å‘¨å›´æœ‰ç»¿è‰²çš„æ£®æ—å’Œå°ç²¾çµ">ğŸ° é­”æ³•åŸå ¡å’Œç²¾çµ</div>
                        <div class="prompt-tag" data-prompt="ä¸€åªæé¾™åœ¨æ£®æ—é‡Œåƒæ°´æœ">ğŸ¦• æé¾™åƒæ°´æœ</div>
                        <div class="prompt-tag" data-prompt="ä¸€ä¸ªå¡é€šé£æ ¼å°å¥³å­©åœ¨å †é›ªäºº">â›„ å°å¥³å­©å †é›ªäºº</div>
                        <div class="prompt-tag" data-prompt="ä¸€è‰˜å®‡å®™é£èˆ¹æ­£åœ¨æ˜Ÿé™…èˆªè¡Œ">ğŸš€ å®‡å®™é£èˆ¹èˆªè¡Œ</div>
                        <div class="prompt-tag" data-prompt="ä¸€åªçƒ­æ°”çƒé£è¶Šå±±è„‰ï¼Œå±±ä¸‹æœ‰å°æ‘åº„">ğŸˆ çƒ­æ°”çƒé£è¡Œ</div>
                        <div class="prompt-tag" data-prompt="ä¸€ä¸ªæœºå™¨äººåœ¨ç©è¶³çƒ">ğŸ¤– æœºå™¨äººè¸¢è¶³çƒ</div>
                        <div class="prompt-tag" data-prompt="ä¸€ä¸ªæ°´ä¸‹åŸå¸‚ï¼Œæœ‰é±¼å„¿å’Œç¾äººé±¼">ğŸ§œâ€â™€ï¸ æ°´ä¸‹åŸå¸‚</div>
                        <div class="prompt-tag" data-prompt="ä¸€ä¸ªç«¥è¯æ£®æ—ï¼Œæœ‰å¤§å¤§çš„è˜‘è‡æˆ¿å­å’Œå°åŠ¨ç‰©">ğŸ„ ç«¥è¯æ£®æ—</div>
                    </div>
                </div>
				
			<!-- è¾“å…¥æ¡†åŒºåŸŸ -->
			<div class="input-container">
				<textarea id="userInput" placeholder="ä¸€åªå¯çˆ±çš„å°ç‹—åœ¨è‰åœ°ä¸Šç©è€ï¼Œæ—è¾¹æœ‰è´è¶åœ¨é£èˆ" rows="1"></textarea>
				<button id="btnphoto"   onclick="aiPhoto()" title="æ–‡æœ¬ç”Ÿæˆå›¾ç‰‡">ç”Ÿæˆå›¾ç‰‡</button>
			</div>
			
			<div class="photo-container" id="chatHistory">
				<!-- èŠå¤©è®°å½•å°†åŠ¨æ€åŠ è½½åˆ°è¿™é‡ŒğŸ³  -->
			</div>
        </div>	
		
        <div class="right-column">
			<!-- å¯¼èˆªæ  -->
			<div class="photobar">
			ç»˜ç”»ä½œå“åˆ—è¡¨
			</div>
			<!-- èŠå¤©è®°å½•æ  -->
			<div id ="chatbar">			
			</div>
        </div>

 </div>
    <script>
		
		const userTextarea = document.getElementById("userInput");
		const chatHistory = document.getElementById("chatHistory");
		const userchatbar = document.getElementById("chatbar");
        const sendButtonphoto = document.getElementById("btnphoto");
		var imgload = new Image();
		imgload.src = "loading.gif";
		
		//æ–‡ç”Ÿå›¾
		function aiPhoto(){
			sendButtonphoto.disabled = true;
			chatHistory.innerHTML ="";
			chatHistory.appendChild(imgload);
			var prompt = userTextarea.value.trim();
            width = 600;
            height = 480;
            seed = 30;
			model = 'flux';
			var  encoded_prompt = encodeURIComponent(prompt);	
			
			image_url = "https://pollinations.ai/p/"+encoded_prompt+"?width="+width+"&height="+height+"&seed="+seed+"&model="+model+"&nologo=true&safe=true"
			
			// è·å–canvaså…ƒç´ å’Œç»˜å›¾ä¸Šä¸‹æ–‡
			var canvas = document.createElement('canvas');
			canvas.width = width;
			canvas.height = height;
			var ctx = canvas.getContext('2d');		 
			// åˆ›å»ºä¸€ä¸ªæ–°çš„Imageå¯¹è±¡
			var img = new Image();
			img.src = image_url;
			// å½“å›¾ç‰‡åŠ è½½å®Œæˆåï¼Œå°†å…¶ç»˜åˆ¶åˆ°canvasä¸Š
			img.onload = function() {				
				ctx.drawImage(img, 0, 0, width, height); 
				// åœ¨canvasä¸Šç»˜åˆ¶å›¾ç‰‡ï¼Œå¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´ä½ç½®å’Œå¤§å°
				chatHistory.innerHTML ="";
				chatHistory.appendChild(canvas);
				
				var thumbnailCanvas = document.createElement('canvas');
				thumbnailCanvas.width = 200;
				thumbnailCanvas.height = 160;
				var thumbnailCtx = thumbnailCanvas.getContext('2d');
				thumbnailCtx.drawImage(canvas, 0, 0, 600, 480, 0, 0,200, 160); // ä½¿ç”¨ç¼©æ”¾æ¯”ä¾‹è°ƒæ•´å¤§å°å¹¶ç»˜åˆ¶åˆ°æ–°çš„canvasä¸Š
				userchatbar.appendChild(thumbnailCanvas);
                // å¹³æ»‘æ»šåŠ¨åˆ°é¡¶éƒ¨è¡¨å•åŒºåŸŸ
                window.scrollTo({
                    top: userTextarea.offsetTop - 200,
                    behavior: 'smooth'
                });
				
				sendButtonphoto.disabled = false;
			};
		}
	
	// è‡ªåŠ¨è°ƒæ•´è¾“å…¥æ¡†é«˜åº¦
	document.getElementById("userInput").addEventListener("input", (event) => {
		event.target.style.height = "auto";
		event.target.style.height = event.target.scrollHeight + "px";
	});
		
		
	initPromptTags();
	initStyleSelector();
	
	    /**
     * åˆå§‹åŒ–æç¤ºè¯æ ‡ç­¾
     */
    function initPromptTags() {
        // è·å–æç¤ºè¯å®¹å™¨
        const promptTagsContainer = document.querySelector('.prompt-tags-container');
        if (!promptTagsContainer) {
            console.error('æ‰¾ä¸åˆ°æç¤ºè¯å®¹å™¨å…ƒç´ ');
            return;
        }
        
        // å…‹éš†å¹¶æ›¿æ¢å®¹å™¨ä»¥ç§»é™¤ä¹‹å‰çš„äº‹ä»¶ç›‘å¬å™¨
        const newContainer = promptTagsContainer.cloneNode(true);
        promptTagsContainer.parentNode.replaceChild(newContainer, promptTagsContainer);
        
        // è·å–æ‰€æœ‰æç¤ºè¯æ ‡ç­¾
        const promptTags = newContainer.querySelectorAll('.prompt-tag');
        
        // ä¸ºæ¯ä¸ªæç¤ºè¯æ ‡ç­¾æ·»åŠ ç‚¹å‡»äº‹ä»¶
        promptTags.forEach(tag => {
            tag.addEventListener('click', function(event) {
                // é˜»æ­¢äº‹ä»¶å†’æ³¡
                event.stopPropagation();
                
                // è·å–æç¤ºè¯å†…å®¹
                const promptText = this.getAttribute('data-prompt');
                if (!promptText) return;
                
                // è·å–æç¤ºè¯è¾“å…¥æ¡†
                const promptInput = document.getElementById('userInput');
                if (!promptInput) return;
                
                // å¡«å……åˆ°è¾“å…¥æ¡†
                promptInput.value = promptText;
                               
                // è®©è¾“å…¥æ¡†è·å¾—ç„¦ç‚¹
                promptInput.focus();
                
                // æ·»åŠ ç®€å•çš„åŠ¨ç”»æ•ˆæœ
                this.style.transform = 'scale(0.9)';
                setTimeout(() => {
                    this.style.transform = '';
                }, 200);                
                
            });
        });
        
    }
	
	/**
     * åˆå§‹åŒ–é£æ ¼é€‰æ‹©å™¨
     */
    function initStyleSelector() {
        // è·å–æ‰€æœ‰é£æ ¼æ ‡ç­¾åŠå…¶çˆ¶å…ƒç´ 
        const styleLabels = document.querySelectorAll('.style-tag');
        
        // æ‰¾åˆ°é»˜è®¤é€‰ä¸­çš„é£æ ¼å¹¶æ·»åŠ activeç±»
        const defaultStyle = document.querySelector('.style-tag input:checked');
        if (defaultStyle) {
            defaultStyle.parentElement.classList.add('active');
        }
        
        // æ¸…é™¤å¹¶é‡æ–°æ·»åŠ ç‚¹å‡»äº‹ä»¶
        styleLabels.forEach(label => {
            // æ¸…é™¤å¯èƒ½å­˜åœ¨çš„åŸæœ‰äº‹ä»¶ç›‘å¬
            const newLabel = label.cloneNode(true);
            label.parentNode.replaceChild(newLabel, label);
            
            // è·å–æ ‡ç­¾ä¸­çš„radio inputå…ƒç´ 
            const radioInput = newLabel.querySelector('input[type="radio"]');
            
            // ä¸ºæ ‡ç­¾æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼ˆä¸æ˜¯ä¸ºradioæ·»åŠ changeäº‹ä»¶ï¼‰
            newLabel.addEventListener('click', (e) => {
                // é˜»æ­¢äº‹ä»¶å†’æ³¡
                e.stopPropagation();
                
                // ç¡®ä¿radioè¢«é€‰ä¸­
                if (radioInput) {
                    radioInput.checked = true;
                    
                    // è§¦å‘ä¸€ä¸ªäººå·¥çš„changeäº‹ä»¶
                    const changeEvent = new Event('change', { bubbles: true });
                    radioInput.dispatchEvent(changeEvent);
                    
                    // é«˜äº®æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾
                    document.querySelectorAll('.style-tag').forEach(el => {
                        el.classList.remove('active');
                    });
                    newLabel.classList.add('active');
                    
                    // æ˜¾ç¤ºæç¤º
                    const styleName = newLabel.querySelector('span').textContent.trim();
					defaultstyle = styleName;
                    // å¦‚æœç”¨æˆ·æ­£åœ¨è¾“å…¥æç¤ºè¯ï¼Œå¯ä»¥æç¤ºé£æ ¼å·²æ”¹å˜
                    const promptInput = document.getElementById('prompt');
                    if (promptInput && promptInput.value.trim() !== '') {
                        // å·²ç¦ç”¨å¼¹çª—æç¤º
                    }
                }
            });
        });
        
    }
		
    </script>
</body>
</html>